(function(){var n,e,t,a,s,r,l=[].indexOf||function(n){for(var e=0,t=this.length;e<t;e++)if(e in this&&this[e]===n)return e;return-1};a=function(){return $.get("/zones.json",function(n,e){var t,a;if("success"===e)return a=n,t=$(".zone-manage").attr("id"),$.get("/user_manage_zones.json?id="+t,function(n){var e,t,s,r,i,o,u,c,d;for(o=function(){var e,a,s;for(s=[],e=0,a=n.length;e<a;e++)t=n[e],s.push(t.id);return s}(),s="<ul class='nav nav-pills'>",r=0,i=a.length;r<i;r++)u=a[r],d=u.name,c=u.id,e="manage-zone",l.call(o,c)>=0&&(e+=" active"),s+="<li class='"+e+"' id='"+c+"' >",s+="<a>"+d+"</a>",s+="</li>";return s+="</ul>",$(".manage-zones").html(s),$(".manage-zone").each(function(){return $(this).click(function(){return c=$(this).attr("id"),$(this).hasClass("active")?$(this).removeClass("active"):$(this).addClass("active")})})})})},s=function(){var n,e;return n=[],$(".manage-zone.active").each(function(){return n.push($(this).attr("id"))}),e=$(".zone-manage").attr("id"),$.post("/user_manage_zones.json?id="+e,{ids:n},function(n,e){return"success"===e?a():console.log("faild..")})},t=function(){return $(".ball").each(function(){var n,e,t;return n=$(this),e=$(".zone-manage").attr("id"),t=$(this).attr("id"),$.get("/get_user_ball.json?user_id="+e+"&zone_id="+t,function(e,t){return"success"===t?(n.html(e.message),"normal"!==e.status&&null!=e.duration_s?(n.removeClass("label-success"),n.addClass("label-danger"),n.parent().find(".ball-duration").html(e.duration_s)):(n.removeClass("label-danger"),n.addClass("label-success"),n.parent().find(".ball-duration").html(""))):n.html("error")})})},r=function(n){var e,a,s,r,l,i;return i=n.find(".zone").attr("id"),r=$(".zone-manage").attr("id"),e=n.find("#"+i+".ball-day").val(),a=n.find("#"+i+".ball-hour").val(),s=n.find("#"+i+".ball-minute").val(),l="&day="+e+"&hour="+a+"&minute="+s,$.get("/set_user_ball.json?user_id="+r+"&zone_id="+i+l,function(n,e){return"success"===e?(console.log("set ball success"),t()):console.log("set ball failed")})},n=function(){return $(".post-zone-manage").click(function(){return s()})},e=function(){return $(".ball-manage").css("display","none"),$(".zone-ball").each(function(){return $(this).click(function(){return $(".modal-title").html($(this).attr("name")),$(".modal-body").html($(this).find(".ball-manage").html()),$(".modal-set").one("click",function(){return r($(".modal-body"))})})})},$(document).ready(function(){return console.log("ready"),n(),e(),a(),t()})}).call(this);